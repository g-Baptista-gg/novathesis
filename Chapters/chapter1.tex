%!TEX root = ../template.tex
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% chapter1.tex
%% NOVA thesis document file
%%
%% Chapter with introduction
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\typeout{NT FILE chapter1.tex}%

\chapter{Introduction}\label{cha:introduction}

\section{Theoretical Introduction}
\subsection{Characteristic x-rays}

\begin{figure}[h!]
    \centering
    \begin{tikzpicture}[
        >={Stealth[scale=2]},
        photon/.style={decorate,decoration={snake,post length=3mm}}
    ]
        \draw (0,0) -- (3,0) node[right]{Inner shell};
        \draw[fill=blue!50!white] (1,0) circle (0.25) node {$\uparrow$};
        \draw[fill=blue!50!white,dashed,opacity=0.5] (2,0) circle (0.25) node {$\downarrow$};
        \draw[->,photon](3.5,1) node[above right]{$h\nu$>E$_{\text{b}}$} -- (2.25,0.25);
    
        \draw[dashed] (0,3) -- (3,3);
        \draw[dashed,draw opacity=0.5] (0,3.1) -- (3,3.1) node[right]{Continuum};
        \draw[dashed,opacity=0.25] (0,3.2) -- (3,3.2);
        \draw[dashed,opacity=0.1] (0,3.3) -- (3,3.3);
        \draw[dashed,opacity=0.05] (0,3.4) -- (3,3.4);
        \draw[fill=blue!50!white] (2,3.5) circle (0.25) node at (2,4){E$_{\text{k}}$=$h\nu$-E$_{\text{b}}$};
        \draw[->] (2,0.3) -- (2,3.2);
    
        \draw[-Stealth] (-0.5,-1) -- (-0.5,4) node[anchor=south east]{E};
        \draw (-0.4,3) -- (-0.6,3) node[left]{0};
        \draw (-0.4,0) -- (-0.6,0) node[left]{-E$_{\text{b}}$};
    \end{tikzpicture}
    \caption{Photoionization}
\end{figure}


\begin{figure}[h!]
    \centering
    \begin{tikzpicture}[
        >={Stealth[scale=2]},
        photon/.style={decorate,decoration={snake,post length=3mm}}
    ]
        \draw (0,0) -- (3,0) node[right]{Inner shell};
        \draw[fill=blue!50!white] (1,0) circle (0.25) node {$\uparrow$};
        \draw[fill=blue!50!white,dashed,opacity=0.5] (2,0) circle (0.25) node {$\downarrow$};
        \draw[->,photon](3.5,1) node[above right]{$h\nu$=E$_{\text{b}_1}$-E$_{\text{b}_2}$} -- (2.25,0.25);
    
        \draw[dashed] (0,3) -- (3,3);
        \draw[dashed,draw opacity=0.5] (0,3.1) -- (3,3.1) node[right]{Continuum};
        \draw[dashed,opacity=0.25] (0,3.2) -- (3,3.2);
        \draw[dashed,opacity=0.1] (0,3.3) -- (3,3.3);
        \draw[dashed,opacity=0.05] (0,3.4) -- (3,3.4);
        \draw[->] (2,0.3) -- (2,1.7);

        \draw (0,2) -- (3,2) node[right]{Upper level};
        \draw[fill=blue!50!white] (2,2) circle (0.25);



        \draw[-Stealth] (-0.5,-1) -- (-0.5,4) node[anchor=south east]{E};
        \draw (-0.4,3) -- (-0.6,3) node[left]{0};
        \draw (-0.4,0) -- (-0.6,0) node[left]{-E$_{\text{b}_1}$};
        \draw (-0.4,2) -- (-0.6,2) node[left]{-E$_{\text{b}_2}$};
    \end{tikzpicture}
    \caption{Resonant Photoexcitation}
\end{figure}


% Fazer state of the art sobre satelites e MCDF

\section{Atomic Structure Calculations}

When studying a system composed of multiple charged bodies, one must consider all the existing interactions. Whilst there are known solutions for the 2-bodies Hydrogenoid systems, with the presence of more non spatially-bound particles (for example an electron, while using the 
Born-Oppenheimer approximation where the nuclei are considered at rest at a fixed position) there is just no analytic solution for the Schrödinger Equation. That way, there was a need for the development of numerical solutions able to solve this problem.

\subsection{The non-relativistic Hamiltonian}

The first approach used in order to solve the many-bodies problem used a non-relativistic consideration. This way, the used Hamiltonian consisted on simply the sum of the system's non-relativistic momentum-related energies and the Coulomb interactions between bodies, while still considering the Born-Oppenheimer approximation.

Essentially, and in atomic units:

\begin{equation}
    H= \underbrace{\displaystyle\sum_i^N \dfrac{1}{2}\laplacian_i  -\frac{Z}{r_i}}_{\text{Individual Hamiltonian}} + \underbrace{\sum_{i<j}^{j}\dfrac{1}{r_{ij}}}_{\text{Pair repulsion}}
    \label{eq:nonRelHam}
\end{equation}

\subsubsection{The Hartree-Fock Method}\label{sec:HF}

Hartree developed an iterative method, further enhanced by Fock and Slater, based on the field self-consistency method.

In this method, while studying a multi-electronic system, such as an atom, each electron's wavefuction is composed as a product of a spacial part, $\psi$, and one indicating the electron's spin, $\chi$, as to account for Pauli's exclusion principle.

\begin{equation}
    u=\psi\chi
\end{equation}

The wavefuction capable of describing the whole system, $\Psi$, should be somewhat of a product of all the wavefunctions describing each individual electron. However, one must not forget the need for this wavefunction respect the antisymmetry principle, due to the electron's fermionic nature. In order to respect this, $\Psi$ is to be composed of a Slater determinant:

\begin{equation}
    \Psi=\frac{1}{\sqrt{N!}}\mqty| u_1(x_1) & u_2(x_1) & \cdots & u_N(x_1)\\
    u_1(x_2) & u_2(x_2) & \cdots & u_N(x_2)\\
    \vdots & \vdots& \ddots&\vdots\\
    u_1(x_N)&u_2(x_N)&\cdots&u_N(x_N)&|
\end{equation}

It is of high importance that the wavefunctions \underline{must} form an orthonormal basis. These are to be initialized as trial wavefunctions. 


The main goal of this method is to follow the variational principle and to minimize a functional, with the purpose of minimizing the system's energy. Assuming the optimal, yet unknown energy, $E_0$ (calculated by Operating the Hamiltonian on the optimal wavefunctions), it is natural to assume the used test functions provide a non-minimized solution, with $\ev**{H}{\Psi}\geq E_0$.

The computational method consists on starting with the previously mentioned test wavefunctions, using them to calculate Hartree-Fock's potential through the HF equations, 


In a very simplified way, the self-consistent Hartree-Fock computational method can be represented by the following block diagram:


\begin{figure}[h!]
    \centering
    \begin{tikzpicture}[node distance=2cm,every text node part/.style={align=center}]
        \node (initWF) [startstop] {Define Initial \\ Test Wavefunctions};
        \node (loadWF) [io, below of=initWF, yshift=-0cm] {Initial \\ Wavefunctions};
        \node (EnCalc1) [process,right of = loadWF,xshift= 2cm]{Compute \\ Energy ($E_i$)};
        \node (calcPotential) [process,below of= loadWF]{Compute density matrix \\ and HF potential};
        \node (calcWF) [process, below of = calcPotential]{Solve HF equations \\ for new potential};
        \node (newWF) [io, below of=calcWF] {New \\ Wavefunctions};
        \node (EnCalc2) [process,right of = newWF,xshift= 2cm]{Compute \\ Energy ($E_f$)};
        \node (EnComp) [decision,below of = newWF,yshift=-1cm]{$E_i-E_f\leq \lambda$?};
        \node (stop) [startstop,right of = EnComp,xshift=2cm] {End of \\ algorithm};

        \draw [arrowdiag] (initWF) -- (loadWF);
        \draw [arrowdiag] (loadWF) -- (EnCalc1);
        \draw [arrowdiag] (loadWF) -- (calcPotential);
        \draw [arrowdiag] (calcPotential) -- (calcWF);
        \draw [arrowdiag] (calcWF) -- (newWF);
        \draw [arrowdiag] (newWF) -- (EnCalc2);
        \draw [arrowdiag] (newWF) -- (EnComp);
        \node (aux1) [left of =EnComp,xshift=-2cm] {No};
        \node (aux2) [left of =loadWF,xshift=-2cm] {Load new WF \\ as initial WF};
        \draw (EnComp) -- (aux1);
        \draw (aux1) -- (aux2);
        \draw [arrowdiag] (aux2) -- (loadWF);
        \draw [arrowdiag] (EnComp) --node[anchor=south]{Yes} (stop);
    \end{tikzpicture}
    \caption{Diagram}
\end{figure}




\subsubsection{Radiative transition type}

One photon transition rates:

Non-relativistic: $dA_{10}=\dfrac{e^2 \omega}{2\pi \hbar c}\abs{\mel**{0}{ \vb*{p\epsilon}^*\cdot\dfrac{1}{m_e c}}{1}}^2$

\subsection{The Dirac Equation}

It is no secret that the Schrödinger equation has some very considerable limitations. The fact that it does not account for the existence of the electron's spin and the lack of consideration of relativistic effects are some of the most impactful setbacks.

That way, a new equation was developed by Paul Dirac, in 1928\cite{Dirac}, one taking into account now not the classical 3 dimensional space components, but the relativistic four components (1 time-like and 3 space-like).

Many scientists, such as Klein, Gordon and later Fock, had already conceived a relativistic correction to Schrödinger's equation, more commonly known as the Klein-Gordon equation\eqref{eq:KG}, where the free-particle energy makes use of the relativistic momentum-energy relation \eqref{eq:EnMomRel}, making Schrödinger's equation now also Lorentz-invariant.
 This new approach was, however, still faulty, due to only describing spin 0 particles (e.g., some mesons), and making use of a second order derivative in the time-like component.

 \begin{equation}
    E=\sqrt{c^2\vb*{p}^2+m^2c^4}
    \label{eq:EnMomRel}
 \end{equation}

Which can be derived from:

 \begin{equation}
    \dfrac{E^2}{c^2}= \vb*{p}^2 +m^2c^2 \Leftrightarrow \dfrac{E^2}{c^2}-\vb*{p}^2=m^2c^2\Leftrightarrow p^\mu p_\mu = m^2c^2
 \end{equation}
 Just as a reminder, since now relativistic effects are being taken into account, the momentum vector is now a 4-vector, composed of one time-like and 3 space-like components: $p^\mu=(p^0.p^1,p^2,p^3)=(p^0,\vb*{p})=\qty(\dfrac{E}{c},\vb*{p})$

 \begin{equation}
    -\hbar^2 \pdv[2]{t} \vb*{\psi}=-c^2\hbar^2\laplacian + m^2c^4\vb*{\psi}
    \label{eq:KG}
\end{equation}

 Dirac took a spin at rewriting the energy-momentum relation, ending up with an equivalent equation\eqref{eq:diracEnergy}, involving $4\times 4$ matrices, due to the 4 relativistic dimensions at play, and incorporating spins into the equation by making use of the now famous Pauli matrices, $\vb*{\sigma}$:

 \begin{equation}
    E=c\vb*{\alpha}\cdot \vb*{p}+{\beta} mc^2,\quad \vb*{\alpha}=\qty(\alpha_1,\alpha_2,\alpha_3)
    \label{eq:diracEnergy}
 \end{equation}

 \begin{align}
    \alpha_i&=\mqty(0 & {\sigma}_i\\ {\sigma}_i&0) & {\beta}&=\mqty(I_2 & 0 \\ 0 &-I_2) &I_2&=\mqty(1&0\\0&1)\\
    \sigma_1&=\mqty(0&1\\1&0) & \sigma_2&=\mqty(0&-i\\i&0)& \sigma_3&=\mqty(1&0\\0&-1)
 \end{align}

 In order to fully comprehend this shift of notation, one should equate the square of the two equations, \eqref{eq:EnMomRel} and \eqref{eq:diracEnergy}, and confirm if logic still stands.

 \begin{equation}
    c^2 \vb*{p}^2 + m^2c^4 = c^2\vb*{\alpha}^2\vb*{p}^2+2 m c^3 \vb*{\alpha}\cdot \vb*{p} \cdot \beta + \beta^2 m^2 c^4
 \end{equation}

 In order for this equation to make sense, the following conditions must be true (which in fact, they are):

\begin{gather}
    \begin{cases}
        c^2\vb*{p}^2=c^2\vb*{\alpha}^2 p^2  &\Leftrightarrow \vb*{\alpha}^2=1\\
        0=2mc^3  p \vb*{\alpha} \beta &\Leftrightarrow \vb*{\alpha} \beta =0\\
        m^2c^4=\beta^2 m^2c^4     &\Leftrightarrow \beta^2 =1
    \end{cases}
\end{gather}

As expected, the eigenfunctions obtained from solving this equation, will now have a 4th time-like component, in addition to the already expected 3 space-like components.


With all the previous considerations taken into account, one can now construct Dirac's free-particle equation\eqref{eq:DiracEq}:

\begin{equation}
    i\hbar \pdv{t}\vb*{\psi}=\qty( c\vb*{\alpha}\cdot \vb*{p} +\beta m c^2)\vb*{\psi}=\mqty(mc^2 I_2& -i\hbar c \vb*{\sigma}\cdot \grad\\-i\hbar c \vb*{\sigma}\cdot \grad & -mc^2 I_2)\cdot \mqty(\psi_1\\\vdots\\\psi_4)
    \label{eq:DiracEq}
\end{equation}

This equation, however, as previously mentioned above, can only describe a single particle present in a field-free region. In order to account for the existence of a field, such as the electromagnetic field, derived from the four-potential $A^\mu$, composed by the electric scalar potential, $A^0=\phi$, and the vector potential, $(A^1,A^2,A^3)=\vb*{A}$:


\begin{equation}
    p^\mu \rightarrow p^\mu - e A^\mu,\quad A^\mu = \qty(\phi,\vb*{A})
\end{equation}

The Hamiltonian can now be rewritten as to account for the presence of the electromagnetic field \eqref{eq:DiracEqField}. This way it is possible to include, for example, the electron-nucleus Coulomb attraction.

\begin{equation}
    H_D=-e\phi + \beta m c^2 + \vb*{\alpha}\qty(c\vb*{p}+e\vb*{A})
    \label{eq:DiracEqField}
\end{equation}

For a central potential, as is the one generated by the nuclear charge, the 3 space-like components from the four-potential are null, and the time-like component, $\phi=\dfrac{Z e}{r}$. The equation gains now a more recognizable term:

\begin{equation}
    H_D=-\frac{e^2 Z}{r} + \beta m c^2 + \vb*{\alpha}\cdot\vb*{p}c
    \label{eq:diracHam}
\end{equation}

\subsection{The Dirac-Breit Equation}

Once again, when considering a system composed of many bodies, one must consider all the present interactions, namely, the electron-electron repulsion in an atom.
 Breit, in 1929, had already created a relativistic approach to treat the electron-electron interactions, consisting on a set of equations building upon the classical non-relativistic Hamiltonian from equation \eqref{eq:nonRelHam}, which can be consulted in appendix \ref{ap:Breit}.
  Breit's equations are able to account for angular momenta couplings and estimate level energy splittings, the change of a particle's apparent mass as a function of velocity, and even include the interaction of an applied external magnetic field.\cite{Bethe1977}

  It is quite obvious Breit's equations introduce a great complexity in the search of the new Hamiltonian's eigenfunctions. However, when trying to include an approximation of Breit's considerations into Dirac's equation, one must add the following operator to the one present in equation \eqref{eq:diracHam}:

  \begin{equation}
    H_B = \sum_{i>j}\frac{e^2}{r_{ij}} - e^2\qty(\frac{\vb*{\alpha}_i\vb*{\alpha}_j}{r_{ij}}+\frac{\qty(\vb*{\alpha}_i \grad_i)\qty(\vb*{\alpha}_j \grad_j)r_{ij}}{2})  
    \label{eq:BreitHam}
  \end{equation}

\subsection{The \gls{MCDFGME} Method}

As previously mentioned in section \ref{sec:HF}, there is a need for a numerical method in order to compute and find the eigenfunctions for a many-body Hamiltonian. While the Hartree-Fock method was able to reasonably solve the non-relativistic problem, now, while considering the Dirac-Breit Hamiltonian from equations \eqref{eq:diracHam} and \eqref{eq:BreitHam}, there is a need for a new method.

Hence, the state of the art \gls{MCDFGME} arises. This self-consistent iterative method, based on the same method present in section \ref{sec:HF}, is able to solve and find eigenfunctions for a multielectronic system, now taking into account the Dirac-Breit Hamiltonian. Moreover, it is also capable of incorporating electron correlation and many QED effects not yet considered in the relativistic equation, such as the Lamb-shift, vacuum polarization, and the electron's self energy.
A brief description of these contributions can be found in  appendix ???

EXPLICAR A GENERAL MATRIX OF ELEMENTS.


\section{State of the Art}


\subsection{Copper's characteristic x-rays}
\subsection{MCDFGME capabilities}

\section{Objectives}

\section{Methodology}

As previously mentioned before, in this thesis, atomic relaxation transitions where the ejected inner shell electron, responsible for the generated hole, was, not sent to the continuum, but excited to an upper state.

In order to use \gls{MCDFGME}, since it is written in FORTRAN, there will be a multitude of I/O files, with the extension \textit{.f0X}. The most important file extensions are \textit{.f05}, the input file, where the calculation settings are indicated; \textit{.f06}, where the cyclical energy results will be displayed, among others, such as the non-diagonal matrix element overlaps, both important to evaluate the convergence.
 Other file extensions, such as \textit{.f09} can be quite useful for debugging processes, and for calculating other atomic parameters, such as shake probabilities, which will not be of relevance as of this thesis.

 An example of a normal atomic structure calculation for an excited Copper atom (which has a ground state configuration of $1s^2 2s^2 2p^6 3s^2 3p^6 3d^{10} 4s^1$) is as follows:

 One starts by choosing the excitation upper orbital, and by  writing, in a text file all the possible 1 hole configurations from where the electron may have originated from. An example can be found in Annex ????. This represents all the possible excited states where the electron is in the chose orbital.
 
 The same process is now performed for a 2 hole configuration, where an additional ionization occurred. This represents the possible states after the occurrence of the Auger process, which is in competition with the radiative decay.

 Now, a \textit{bash} script, \textit{runMCDFEC.sh} is to be executed. Now, it will be possible to choose the atomic number of the element in study, the isotope mass, and, if one wishes so, to perform the calculations for an exotic atom, where, instead of electrons, other particles such as muons, negative hadrons and antiparticles can orbit the nucleus. 
 The script will, for all given configurations, calculate all the possible spin-orbit couplings and eigenvalues, and then finally apply the \gls{MCDFGME} method.

 Depending on the excitation orbital, there will be thousands to tens of thousands of possibilities for the final configuration, with this number increasing with the quantum number of angular momentum, $l$, of the orbital.
 
 However, not all the calculations automatically performed will converge. Each time, a couple of hundreds of computed orbitals will fail convergence. In a file, generated for the compilation of the calculation results, these orbitals will be missing the total system's energy, or will display a significant energy difference for the results of using two different methods, \textbf{breaking the method's self-consistency???}.

 The configurations that were not able to converge will now have to be converged by hand. In order to do this, their \textit{.f05} will have to be edited, where different methods will be chosen for the calculation for each specific orbital. This can be quite time-consuming, as there are multiple possible methods and possible combinations, and there is just no right way to converge an orbital, hence why this step can even take a couple of weeks to finish.

 After eliminating all the convergence problems, the radiative transition rates will be calculated, by operating the transition operator on all the possible 1 hole - 1 hole configuration pair combinations. The same will follow for all the pairs of 1hole - 2 holes configurations, in order to compute the auger transition rates. Finally, the process is repeated for the 2 holes - 2 holes configurations, for the radiative transitions of the auger-generated satellite states.

 The energy of the transition is calculated through the configuration pair's energetic difference, and the transition's natural broadening is calculated by:

\section{Work Plan}

